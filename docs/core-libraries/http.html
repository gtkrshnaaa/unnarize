<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ucoreHttp - Unnarize</title>
    <link rel="stylesheet" href="../css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
    <button class="menu-toggle" aria-label="Toggle menu">
        <span></span>
        <span></span>
        <span></span>
    </button>
    <div class="sidebar-overlay"></div>
    <div class="layout">
        <nav class="sidebar">
            <div class="sidebar-logo">Unnarize</div>
            <div class="nav-section">
                <div class="nav-title">Getting Started</div>
                <ul class="nav-links">
                    <li><a href="../index.html">Introduction</a></li>
                    <li><a href="../getting-started.html">Installation</a></li>
                </ul>
            </div>
            <div class="nav-section">
                <div class="nav-title">Language</div>
                <ul class="nav-links">
                    <li><a href="../language/variables.html">Variables</a></li>
                    <li><a href="../language/operators.html">Operators</a></li>
                    <li><a href="../language/arrays.html">Arrays</a></li>
                    <li><a href="../language/structs.html">Structs</a></li>
                    <li><a href="../language/control-flow.html">Control Flow</a></li>
                    <li><a href="../language/functions.html">Functions</a></li>
                    <li><a href="../language/modules.html">Modules</a></li>
                    <li><a href="../language/async.html">Async/Await</a></li>
                </ul>
            </div>
            <div class="nav-section">
                <div class="nav-title">Core Libraries</div>
                <ul class="nav-links">
                    <li><a href="string.html">ucoreString</a></li>
                    <li><a href="scraper.html">ucoreScraper</a></li>
                    <li><a href="json.html">ucoreJson</a></li>
                    <li><a href="http.html">ucoreHttp</a></li>
                    <li><a href="timer.html">ucoreTimer</a></li>
                    <li><a href="system.html">ucoreSystem</a></li>
                    <li><a href="uon.html">ucoreUon</a></li>
                </ul>
            </div>
            <div class="nav-section">
                <div class="nav-title">Examples</div>
                <ul class="nav-links">
                    <li><a href="../examples/basics.html">Basics</a></li>
                    <li><a href="../examples/sme-system.html">SME System</a></li>
                </ul>
            </div>
        </nav>
        
        <main class="main">
            <h1>ucoreHttp</h1>
            <p class="lead">HTTP client and server functionality.</p>
            
            <h2>Functions</h2>
            <table>
                <thead><tr><th>Function</th><th>Returns</th><th>Description</th></tr></thead>
                <tbody>
                    <tr>
                        <td><code>get(url)</code></td>
                        <td>string</td>
                        <td>HTTP GET request</td>
                    </tr>
                    <tr>
                        <td><code>post(url, body)</code></td>
                        <td>string</td>
                        <td>HTTP POST request</td>
                    </tr>
                    <tr>
                        <td><code>json(data)</code></td>
                        <td>string</td>
                        <td>Serialize data to JSON string</td>
                    </tr>
                    <tr>
                        <td><code>route(method, path, handler)</code></td>
                        <td>bool</td>
                        <td>Register a route handler</td>
                    </tr>
                    <tr>
                        <td><code>listen(port, [handler])</code></td>
                        <td>bool</td>
                        <td>Start HTTP server</td>
                    </tr>
                    <tr>
                        <td><code>put(url, body)</code></td>
                        <td>string</td>
                        <td>HTTP PUT request</td>
                    </tr>
                    <tr>
                        <td><code>delete(url)</code></td>
                        <td>string</td>
                        <td>HTTP DELETE request</td>
                    </tr>
                    <tr>
                        <td><code>patch(url, body)</code></td>
                        <td>string</td>
                        <td>HTTP PATCH request</td>
                    </tr>
                    <tr>
                        <td><code>use(middleware)</code></td>
                        <td>bool</td>
                        <td>Register global middleware</td>
                    </tr>
                    <tr>
                        <td><code>static(path, dir)</code></td>
                        <td>bool</td>
                        <td>Serve static files from directory</td>
                    </tr>
                </tbody>
            </table>
            
            <h2>HTTP Client</h2>
            
            <h3>get(url)</h3>
            <p>Performs an HTTP GET request. Returns the response body as a string.</p>
            <pre><code><span class="token-keyword">var</span> response = ucoreHttp.<span class="token-function">get</span>(<span class="token-string">"http://example.com/api"</span>);
<span class="token-function">print</span>(response);</code></pre>
            
            <h3>post(url, body)</h3>
            <p>Performs an HTTP POST request with the given body.</p>
            <pre><code><span class="token-keyword">var</span> data = ucoreHttp.<span class="token-function">json</span>(myData);
<span class="token-keyword">var</span> response = ucoreHttp.<span class="token-function">post</span>(<span class="token-string">"http://example.com/api"</span>, data);
<span class="token-function">print</span>(response);</code></pre>
            
            <h3>json(data)</h3>
            <p>Serializes a map, array, or primitive to JSON string.</p>
            <pre><code><span class="token-keyword">var</span> data = <span class="token-function">map</span>();
data[<span class="token-string">"name"</span>] = <span class="token-string">"Unnarize"</span>;
data[<span class="token-string">"version"</span>] = <span class="token-string">"1.0"</span>;

<span class="token-keyword">var</span> jsonStr = ucoreHttp.<span class="token-function">json</span>(data);
<span class="token-function">print</span>(jsonStr);  <span class="token-comment">// {"name":"Unnarize","version":"1.0"}</span></code></pre>
            
            <h2>HTTP Server</h2>
            
            <h3>Handler Function</h3>
            <p>Handler functions receive a request map with <code>method</code>, <code>path</code>, and <code>body</code>:</p>
            <pre><code><span class="token-keyword">function</span> <span class="token-function">handleRequest</span>(req) {
    <span class="token-function">print</span>(<span class="token-string">"Method: "</span> + req[<span class="token-string">"method"</span>]);
    <span class="token-function">print</span>(<span class="token-string">"Path: "</span> + req[<span class="token-string">"path"</span>]);
    <span class="token-function">print</span>(<span class="token-string">"Body: "</span> + req[<span class="token-string">"body"</span>]);
    
    <span class="token-keyword">return</span> <span class="token-string">"Hello from Unnarize!"</span>;
}</code></pre>
            
            <h3>route(method, path, handlerName)</h3>
            <p>Registers a route. Handler name is passed as a string.</p>
            <pre><code>ucoreHttp.<span class="token-function">route</span>(<span class="token-string">"GET"</span>, <span class="token-string">"/"</span>, <span class="token-string">"handleIndex"</span>);
ucoreHttp.<span class="token-function">route</span>(<span class="token-string">"GET"</span>, <span class="token-string">"/api"</span>, <span class="token-string">"handleApi"</span>);
ucoreHttp.<span class="token-function">route</span>(<span class="token-string">"POST"</span>, <span class="token-string">"/echo"</span>, <span class="token-string">"handleEcho"</span>);</code></pre>
            
            <h3>listen(port, [handlerName])</h3>
            <p>Starts the HTTP server. Second parameter is optional - if provided, all requests go to that handler. Otherwise, uses registered routes.</p>
            <pre><code><span class="token-comment">// With routing</span>
ucoreHttp.<span class="token-function">listen</span>(<span class="token-number">8080</span>);

<span class="token-comment">// With single handler (bypasses routing)</span>
ucoreHttp.<span class="token-function">listen</span>(<span class="token-number">8080</span>, <span class="token-string">"handleRequest"</span>);</code></pre>
            
            <h2>Complete Server Example</h2>
            <pre><code><span class="token-keyword">function</span> <span class="token-function">handleApi</span>(req) {
    <span class="token-keyword">var</span> response = <span class="token-function">map</span>();
    response[<span class="token-string">"status"</span>] = <span class="token-string">"ok"</span>;
    response[<span class="token-string">"timestamp"</span>] = ucoreTimer.<span class="token-function">now</span>();
    <span class="token-keyword">return</span> ucoreHttp.<span class="token-function">json</span>(response);
}

ucoreHttp.<span class="token-function">route</span>(<span class="token-string">"GET"</span>, <span class="token-string">"/api"</span>, <span class="token-string">"handleApi"</span>);
<span class="token-function">print</span>(<span class="token-string">"Server starting on :8080"</span>);
ucoreHttp.<span class="token-function">listen</span>(<span class="token-number">8080</span>);</code></pre>
            
            <h2>Example</h2>
            <pre><code>./bin/unnarize examples/corelib/http/server.unna</code></pre>
        </main>
    </div>
    <script src="../js/main.js"></script>
</body>
</html>
